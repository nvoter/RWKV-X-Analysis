# RWKV-X-Analysis
Репозиторий с артефактами экспериментальной оценки архитектуры RWKV-X на бенчмарках NeedleInAHaystack и BABILong

Для воспроизведения экспериментов необходимо создать папки `models/`, указанные в структуре репозитория, и добавить в них веса из [официального репозитория Hugging Face](https://huggingface.co/howard-hou/RWKV-X/tree/main)

## Структура репозитория
### `rwkv-x-babilong/` 
Артефакты тестирования весов на бенчмарке BABILong
- `rwkvx.ipynb` - ноутбук с кодом тестов и визуализации результатов
- `results/` - результаты тестов 
- `models/` - веса моделей из официального репозитория
---
### `rwkv-x-niah/` 
Артефакты тестирования весов на бенчмарке NeedleInAHaystack
- `rwkvx.ipynb` - ноутбук с кодом тестов и визуализации результатов
- `Qwen NIAH Server.ipynb` - код запуска сервера с Qwen 30B для оценки результатов модели
- `contexts/` -  контексты, сгенерированные бенчмарком для тестов
- `results/` - результаты тестовых прогонов
- `models/` - веса моделей из официального репозитория
- `LLMTest_NeedleInAHaystack` - код бенчмарка
    - `needlehaystack/providers/rwkvx.py` - обертка для интеграции RWKV-X в бенчмарк
    - `needlehaystack/evaluators/qwen.py` - кастомный LLM-as-a-judge эвалюатор, отправляющий запросы к Qwen и получающий результаты оценки
---
### `rwkv-x-training/`
Пайплайн для дообучения моделей RWKV-X